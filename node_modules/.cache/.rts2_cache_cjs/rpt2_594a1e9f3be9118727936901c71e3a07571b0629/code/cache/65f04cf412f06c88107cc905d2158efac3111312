{"code":"import axios, { AxiosError } from 'axios';\r\nimport JsSHA from 'jssha';\r\nimport qs from 'qs';\r\nimport { PaymentMethod } from './types';\r\nexport var Env;\r\n(function (Env) {\r\n    Env[\"PROD\"] = \"prod\";\r\n    Env[\"QA\"] = \"qa\";\r\n    Env[\"DEV\"] = \"dev\";\r\n})(Env || (Env = {}));\r\nexport const envUrls = Object.freeze({\r\n    [Env.PROD]: 'https://brn-ybus-pubapi.sa.cz/restapi',\r\n    [Env.QA]: 'https://brn-qa-ybus-pubapi.sa.cz/restapi',\r\n    [Env.DEV]: 'https://brn-dev-ybus-pubapi.sa.cz/restapi',\r\n});\r\nexport const paramsSerializer = {\r\n    serialize: (params) => qs.stringify(params, { indices: false }),\r\n};\r\nconst TIMEOUT = 30000;\r\nexport const api = axios.create({\r\n    baseURL: envUrls[Env.QA],\r\n    timeout: TIMEOUT,\r\n    headers: { 'Cache-Control': 'no-cache' },\r\n    paramsSerializer,\r\n    transitional: {\r\n        clarifyTimeoutError: true,\r\n    },\r\n});\r\nexport const resInterceptor = (onUnauthorized) => api.interceptors.response.use((response) => {\r\n    delete api.defaults.headers.common['X-ReCaptcha-Token'];\r\n    return response;\r\n}, async (error) => {\r\n    if (axios.isCancel(error)) {\r\n        return;\r\n    }\r\n    if (error?.response?.status === 401) {\r\n        onUnauthorized();\r\n    }\r\n    return Promise.reject(error);\r\n});\r\nconst bodyHashEndpoints = [\r\n    '/tickets/create/unregistered',\r\n    '/users/login/registeredAccount',\r\n    '/users/login/unregisteredAccount',\r\n    '/users/login/email',\r\n    '/users/signup/registeredAccount',\r\n    '/users/forgottenPassword/email',\r\n    '/tickets/timetickets/unregistered',\r\n];\r\nexport const getHashedData = (data, hash) => {\r\n    const shaObj = new JsSHA('SHA3-512', 'TEXT');\r\n    const cleanedData = typeof data === 'string' ? data : JSON.stringify(data);\r\n    shaObj.setHMACKey(hash, 'TEXT');\r\n    shaObj.update(cleanedData);\r\n    return shaObj.getHMAC('HEX');\r\n};\r\nexport const reqInterceptor = (hash) => api.interceptors.request.use((req) => {\r\n    const token = req.headers?.Authorization?.split(' ')[1];\r\n    // @ts-expect-error workaround for hiding token hash\r\n    // YBUS is requiring the token hash once and doesn't want it the other time ... ¯\\_(ツ)_/¯\r\n    const hideTokenHash = req.hideTokenHash;\r\n    if (!req.headers) {\r\n        req.headers = {};\r\n    }\r\n    if (!req.url?.includes('const') && !hideTokenHash) {\r\n        if (token && !bodyHashEndpoints.includes(req.url || '')) {\r\n            req.headers['X-Token-Hash'] = getHashedData(token, hash);\r\n        }\r\n        else if (req.data) {\r\n            req.headers['X-Body-Hash'] = getHashedData(req.data, hash);\r\n        }\r\n    }\r\n    if (hideTokenHash) {\r\n        // @ts-expect-error hideTokenHash\r\n        delete req.hideTokenHash;\r\n    }\r\n    req.headers.Referer = 'regiojet:///';\r\n    return req;\r\n});\r\nexport const TIMEOUT_MESSAGE = 'alert.outage';\r\nexport const FAIL_MESSAGE = 'alert.fail';\r\nexport const NETWORK_MESSAGE = 'alert.network';\r\nexport const getErrorMessage = (error) => {\r\n    if (!error) {\r\n        return;\r\n    }\r\n    switch (error.code) {\r\n        // we want to ignore canceled requests\r\n        case AxiosError.ERR_CANCELED:\r\n            return;\r\n        case AxiosError.ETIMEDOUT:\r\n        case AxiosError.ECONNABORTED:\r\n            return TIMEOUT_MESSAGE;\r\n        case AxiosError.ERR_NETWORK:\r\n        case 'ENOTFOUND':\r\n            return NETWORK_MESSAGE;\r\n    }\r\n    return FAIL_MESSAGE;\r\n};\r\nexport const langPriorityCountries = Object.freeze({\r\n    cs: ['CZ', 'SK'],\r\n    de: ['DE', 'AT', 'CZ'],\r\n    'de-AT': ['AT', 'DE', 'CZ'],\r\n    en: ['UK', 'BE', 'NL', 'LU', 'DE'],\r\n    hu: ['HU', 'SK', 'AT'],\r\n    pl: ['PL', 'CZ', 'SK', 'UA'],\r\n    sk: ['SK', 'CZ', 'AT'],\r\n    uk: ['UA', 'CZ', 'PL', 'SK', 'HU'],\r\n});\r\nexport const unusablePaymentMethods = [\r\n    PaymentMethod.Cash,\r\n    PaymentMethod.Transfer,\r\n    PaymentMethod.Giftcertificate,\r\n];\r\n//# sourceMappingURL=consts.js.map","references":["/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/axios/index.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/jssha/dist/sha.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/@types/qs/index.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/src/hooks/types.ts"],"map":"{\"version\":3,\"file\":\"consts.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/hooks/consts.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,KAAK,EAAE,EAAE,UAAU,EAA2B,MAAM,OAAO,CAAC;AACnE,OAAO,KAAK,MAAM,OAAO,CAAC;AAC1B,OAAO,EAAE,MAAM,IAAI,CAAC;AACpB,OAAO,EAAY,aAAa,EAAkB,MAAM,SAAS,CAAC;AAElE,MAAM,CAAN,IAAY,GAIX;AAJD,WAAY,GAAG;IACb,oBAAa,CAAA;IACb,gBAAS,CAAA;IACT,kBAAW,CAAA;AACb,CAAC,EAJW,GAAG,KAAH,GAAG,QAId;AAED,MAAM,CAAC,MAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC;IACnC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,uCAAuC;IACnD,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,0CAA0C;IACpD,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,2CAA2C;CACvD,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,gBAAgB,GAA4B;IACvD,SAAS,EAAE,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC;CAChE,CAAC;AAEF,MAAM,OAAO,GAAG,KAAK,CAAC;AAEtB,MAAM,CAAC,MAAM,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC;IAC9B,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC;IACxB,OAAO,EAAE,OAAO;IAChB,OAAO,EAAE,EAAE,eAAe,EAAE,UAAU,EAAE;IACxC,gBAAgB;IAChB,YAAY,EAAE;QACZ,mBAAmB,EAAE,IAAI;KAC1B;CACF,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,cAAc,GAAG,CAAC,cAA0B,EAAE,EAAE,CAC3D,GAAG,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC3B,CAAC,QAAQ,EAAE,EAAE;IACX,OAAO,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAAC;IACxD,OAAO,QAAQ,CAAC;AAClB,CAAC,EACD,KAAK,EAAE,KAAK,EAAE,EAAE;IACd,IAAI,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;QACzB,OAAO;KACR;IACD,IAAI,KAAK,EAAE,QAAQ,EAAE,MAAM,KAAK,GAAG,EAAE;QACnC,cAAc,EAAE,CAAC;KAClB;IAED,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AAC/B,CAAC,CACF,CAAC;AAEJ,MAAM,iBAAiB,GAAG;IACxB,8BAA8B;IAC9B,gCAAgC;IAChC,kCAAkC;IAClC,oBAAoB;IACpB,iCAAiC;IACjC,gCAAgC;IAChC,mCAAmC;CACpC,CAAC;AAEF,MAAM,CAAC,MAAM,aAAa,GAAG,CAAC,IAAa,EAAE,IAAY,EAAU,EAAE;IACnE,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;IAC7C,MAAM,WAAW,GAAG,OAAO,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IAC3E,MAAM,CAAC,UAAU,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;IAChC,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;IAC3B,OAAO,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;AAC/B,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,cAAc,GAAG,CAAC,IAAY,EAAE,EAAE,CAC7C,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE;IACnC,MAAM,KAAK,GAAI,GAAG,CAAC,OAAO,EAAE,aAAoC,EAAE,KAAK,CACrE,GAAG,CACJ,CAAC,CAAC,CAAC,CAAC;IAEL,oDAAoD;IACpD,yFAAyF;IACzF,MAAM,aAAa,GAAG,GAAG,CAAC,aAAa,CAAC;IAExC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;QAChB,GAAG,CAAC,OAAO,GAAG,EAAE,CAAC;KAClB;IAED,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE;QACjD,IAAI,KAAK,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE;YACvD,GAAG,CAAC,OAAO,CAAC,cAAc,CAAC,GAAG,aAAa,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SAC1D;aAAM,IAAI,GAAG,CAAC,IAAI,EAAE;YACnB,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,aAAa,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SAC5D;KACF;IAED,IAAI,aAAa,EAAE;QACjB,iCAAiC;QACjC,OAAO,GAAG,CAAC,aAAa,CAAC;KAC1B;IAED,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,cAAc,CAAC;IACrC,OAAO,GAAG,CAAC;AACb,CAAC,CAAC,CAAC;AAEL,MAAM,CAAC,MAAM,eAAe,GAAG,cAAc,CAAC;AAC9C,MAAM,CAAC,MAAM,YAAY,GAAG,YAAY,CAAC;AACzC,MAAM,CAAC,MAAM,eAAe,GAAG,eAAe,CAAC;AAE/C,MAAM,CAAC,MAAM,eAAe,GAAG,CAAC,KAAyB,EAAE,EAAE;IAC3D,IAAI,CAAC,KAAK,EAAE;QACV,OAAO;KACR;IACD,QAAQ,KAAK,CAAC,IAAI,EAAE;QAClB,sCAAsC;QACtC,KAAK,UAAU,CAAC,YAAY;YAC1B,OAAO;QACT,KAAK,UAAU,CAAC,SAAS,CAAC;QAC1B,KAAK,UAAU,CAAC,YAAY;YAC1B,OAAO,eAAe,CAAC;QACzB,KAAK,UAAU,CAAC,WAAW,CAAC;QAC5B,KAAK,WAAW;YACd,OAAO,eAAe,CAAC;KAC1B;IACD,OAAO,YAAY,CAAC;AACtB,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,qBAAqB,GAAG,MAAM,CAAC,MAAM,CAEhD;IACA,EAAE,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC;IAChB,EAAE,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;IACtB,OAAO,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;IAC3B,EAAE,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;IAClC,EAAE,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;IACtB,EAAE,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;IAC5B,EAAE,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;IACtB,EAAE,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;CACnC,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,sBAAsB,GAAG;IACpC,aAAa,CAAC,IAAI;IAClB,aAAa,CAAC,QAAQ;IACtB,aAAa,CAAC,eAAe;CAC9B,CAAC\"}","dts":{"name":"/home/karelpelcak/Documents/repo/rj-shop-bl/dist/hooks/consts.d.ts","writeByteOrderMark":false,"text":"import { AxiosError, ParamsSerializerOptions } from 'axios';\r\nimport { Language, PaymentMethod, StationCountry } from './types';\r\nexport declare enum Env {\r\n    PROD = \"prod\",\r\n    QA = \"qa\",\r\n    DEV = \"dev\"\r\n}\r\nexport declare const envUrls: Readonly<{\r\n    prod: \"https://brn-ybus-pubapi.sa.cz/restapi\";\r\n    qa: \"https://brn-qa-ybus-pubapi.sa.cz/restapi\";\r\n    dev: \"https://brn-dev-ybus-pubapi.sa.cz/restapi\";\r\n}>;\r\nexport declare const paramsSerializer: ParamsSerializerOptions;\r\nexport declare const api: import(\"axios\").AxiosInstance;\r\nexport declare const resInterceptor: (onUnauthorized: () => void) => number;\r\nexport declare const getHashedData: (data: unknown, hash: string) => string;\r\nexport declare const reqInterceptor: (hash: string) => number;\r\nexport declare const TIMEOUT_MESSAGE = \"alert.outage\";\r\nexport declare const FAIL_MESSAGE = \"alert.fail\";\r\nexport declare const NETWORK_MESSAGE = \"alert.network\";\r\nexport declare const getErrorMessage: (error?: AxiosError | null) => \"alert.outage\" | \"alert.fail\" | \"alert.network\" | undefined;\r\nexport declare const langPriorityCountries: Readonly<Record<Language, StationCountry[]>>;\r\nexport declare const unusablePaymentMethods: PaymentMethod[];\r\n"}}
