{"code":"import { useEffect } from 'react';\r\nimport { useContextSelector } from 'use-context-selector';\r\nimport { ResponseStateContext } from '../store/responseState/reducer';\r\nimport { ResponseStateCategory } from '../store/responseState/types';\r\nimport { useManualApi } from './useManualApi';\r\nimport useSetResponseState from './useSetResponseState';\r\nconst useAddons = () => {\r\n    const setState = useSetResponseState(ResponseStateCategory.addons);\r\n    const categoryState = useContextSelector(ResponseStateContext, c => c.state[ResponseStateCategory.addons]);\r\n    const [{ loading: addonsLoading, error: addonsError, data }, callAddons] = useManualApi({ url: '/addons', method: 'POST' });\r\n    const [{ loading: verificationLoading, error: verificationError }, callVerifyAddons,] = useManualApi({ url: '/addons/verify', method: 'POST' });\r\n    const [{ loading: putLoading, error: putError }, callPutAddons] = useManualApi({ url: '/addons', method: 'PUT' });\r\n    const fetchAddons = async (payload, signal) => {\r\n        try {\r\n            await callAddons({ data: payload, signal });\r\n            return true;\r\n        }\r\n        catch {\r\n            return false;\r\n        }\r\n    };\r\n    const verifyAddons = async (payload, signal) => {\r\n        try {\r\n            await callVerifyAddons({ data: payload, signal });\r\n            return true;\r\n        }\r\n        catch {\r\n            return false;\r\n        }\r\n    };\r\n    const putAddons = async (ticketId, selectedAddons, signal) => {\r\n        try {\r\n            await callPutAddons({ data: { selectedAddons }, params: { ticketId }, signal });\r\n            return true;\r\n        }\r\n        catch {\r\n            return false;\r\n        }\r\n    };\r\n    useEffect(() => {\r\n        setState(addonsError?.response?.data?.message ||\r\n            verificationError?.response?.data?.message ||\r\n            putError?.response?.data?.message, addonsLoading || verificationLoading || putLoading, addonsError?.response?.data?.errorFields ||\r\n            verificationError?.response?.data?.errorFields ||\r\n            putError?.response?.data?.errorFields);\r\n    }, [\r\n        addonsError,\r\n        addonsLoading,\r\n        verificationError,\r\n        verificationLoading,\r\n        putError,\r\n        putLoading,\r\n    ]);\r\n    return {\r\n        fetchAddons,\r\n        putAddons,\r\n        verifyAddons,\r\n        data: data?.filter((a) => a.maxCount).sort((a, b) => b.price - a.price),\r\n        ...categoryState,\r\n    };\r\n};\r\nexport default useAddons;\r\n//# sourceMappingURL=useAddons.js.map","references":["/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/@types/react/index.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/axios/index.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/use-context-selector/dist/src/index.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/src/store/responseState/reducer.tsx","/home/karelpelcak/Documents/repo/rj-shop-bl/src/store/responseState/types.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/src/hooks/types.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/src/hooks/useManualApi.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/src/hooks/useSetResponseState.ts"],"map":"{\"version\":3,\"file\":\"useAddons.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/hooks/useAddons.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/karelpelcak/Documents/repo/rj-shop-bl/dist/hooks/useAddons.d.ts","writeByteOrderMark":false,"text":"import type { GenericAbortSignal } from 'axios';\r\nimport { AddonsPassengersPayload, Currency, RouteSectionDepArr, SelectedSeat, TicketAddonState } from './types';\r\ninterface AddonCommons {\r\n    addonId: number;\r\n    currency: Currency;\r\n    price: number;\r\n}\r\nexport interface TicketAddon {\r\n    id: number;\r\n    name: string;\r\n    shortDescription: string;\r\n    description: string;\r\n    iconUrl: string;\r\n    infoUrl: string | null;\r\n    infoUrlLabel: string | null;\r\n    price: number;\r\n    currency: Currency;\r\n    conditions: Conditions;\r\n    state: TicketAddonState;\r\n}\r\nexport interface SelectedAddon extends AddonCommons {\r\n    addonCode?: string;\r\n    conditionsHash: string;\r\n    count: number;\r\n}\r\nexport interface VerifyAddonsPayload extends AddonsPassengersPayload {\r\n    selectedAddons: SelectedAddon[];\r\n}\r\nexport interface RouteSectionData extends RouteSectionDepArr {\r\n    selectedSeats: SelectedSeat[];\r\n}\r\nexport interface Addon extends AddonCommons {\r\n    addonCode: string;\r\n    conditions: Conditions;\r\n    shortDescription: string;\r\n    description: string;\r\n    iconUrl: string;\r\n    infoUrl: null | string;\r\n    infoUrlLabel: null | string;\r\n    maxCount: number;\r\n    name: string;\r\n}\r\nexport interface Conditions {\r\n    descriptions: Descriptions;\r\n    code: string;\r\n}\r\nexport interface Descriptions {\r\n    cancel: string;\r\n    rebook: string;\r\n    expiration: string;\r\n}\r\ndeclare const useAddons: () => {\r\n    error?: {\r\n        message?: string | undefined;\r\n        errorFields?: import(\"../store/responseState/types\").ErrorFields[] | undefined;\r\n    } | undefined;\r\n    loading: boolean;\r\n    fetchAddons: (payload: AddonsPassengersPayload, signal?: GenericAbortSignal) => Promise<boolean>;\r\n    putAddons: (ticketId: number, selectedAddons: SelectedAddon[], signal?: GenericAbortSignal) => Promise<boolean>;\r\n    verifyAddons: (payload: VerifyAddonsPayload, signal?: GenericAbortSignal) => Promise<boolean>;\r\n    data: Addon[] | undefined;\r\n};\r\nexport default useAddons;\r\n"}}
