{"code":"import { useMemo } from 'react';\r\nimport { useContextSelector } from 'use-context-selector';\r\nimport { BookingContext } from '../store/booking/reducer';\r\nimport { useManualApi } from './useManualApi';\r\nvar FlexiType;\r\n(function (FlexiType) {\r\n    FlexiType[\"Week\"] = \"WEEK\";\r\n    FlexiType[\"Month\"] = \"MONTH\";\r\n    FlexiType[\"Quarter\"] = \"QUARTER\";\r\n})(FlexiType || (FlexiType = {}));\r\nconst flexiTypes = [FlexiType.Week, FlexiType.Month, FlexiType.Quarter];\r\nconst useTimeTickets = () => {\r\n    const departureDate = useContextSelector(BookingContext, c => c.state.booking?.connection.departureDate);\r\n    const [{ data: flexiClassesWeek, loading: loadingWeek, error: errorWeek }, fetchWeek,] = useManualApi({});\r\n    const [{ data: flexiClassesMonth, loading: loadingMonth, error: errorMonth }, fetchMonth,] = useManualApi({});\r\n    const [{ data: flexiClassesQuarter, loading: loadingQuarter, error: errorQuarter }, fetchQuarter,] = useManualApi({});\r\n    const loading = loadingWeek || loadingMonth || loadingQuarter;\r\n    const error = errorWeek || errorMonth || errorQuarter;\r\n    const isFlexiLoaded = !!(flexiClassesWeek?.length &&\r\n        flexiClassesMonth?.length &&\r\n        flexiClassesQuarter?.length);\r\n    const fetchRoute = async ({ fromStationId, toStationId, tariffs, routeId, }, signal) => {\r\n        await Promise.all([fetchWeek({\r\n                signal,\r\n                url: `/pricelists/timeticket/${routeId}/${fromStationId}/${toStationId}/${FlexiType.Week}/${departureDate}/${tariffs[0]}`,\r\n            }),\r\n            fetchMonth({\r\n                signal,\r\n                url: `/pricelists/timeticket/${routeId}/${fromStationId}/${toStationId}/${FlexiType.Month}/${departureDate}/${tariffs[0]}`,\r\n            }),\r\n            fetchQuarter({\r\n                signal,\r\n                url: `/pricelists/timeticket/${routeId}/${fromStationId}/${toStationId}/${FlexiType.Quarter}/${departureDate}/${tariffs[0]}`,\r\n            })]);\r\n    };\r\n    const data = useMemo(() => (isFlexiLoaded ? [flexiClassesWeek, flexiClassesMonth, flexiClassesQuarter] : [])\r\n        .flatMap((flexiClasses, i) => flexiClasses.map(({ price, seatClassKey, lineNumber, lineGroupCode }) => ({\r\n        flexiType: flexiTypes[i],\r\n        lineGroupCode,\r\n        lineNumber,\r\n        price,\r\n        seatClassKey,\r\n        type: 'FLEXI',\r\n    }))), [isFlexiLoaded]);\r\n    return { data, error, fetchRoute, loading };\r\n};\r\nexport default useTimeTickets;\r\n//# sourceMappingURL=useTimeTickets.js.map","references":["/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/@types/react/index.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/axios/index.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/node_modules/use-context-selector/dist/src/index.d.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/src/store/booking/reducer.tsx","/home/karelpelcak/Documents/repo/rj-shop-bl/src/hooks/useConnectionRoute.ts","/home/karelpelcak/Documents/repo/rj-shop-bl/src/hooks/useManualApi.ts"],"map":"{\"version\":3,\"file\":\"useTimeTickets.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/hooks/useTimeTickets.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/karelpelcak/Documents/repo/rj-shop-bl/dist/hooks/useTimeTickets.d.ts","writeByteOrderMark":false,"text":"import type { GenericAbortSignal } from 'axios';\r\nimport { RoutePayload } from './useConnectionRoute';\r\ndeclare enum FlexiType {\r\n    Week = \"WEEK\",\r\n    Month = \"MONTH\",\r\n    Quarter = \"QUARTER\"\r\n}\r\ndeclare const useTimeTickets: () => {\r\n    data: {\r\n        flexiType: FlexiType;\r\n        lineGroupCode: string;\r\n        lineNumber: number;\r\n        price: number;\r\n        seatClassKey: import(\"./types\").SeatClass;\r\n        type: \"FLEXI\";\r\n    }[];\r\n    error: import(\"axios\").AxiosError<any, any> | null;\r\n    fetchRoute: ({ fromStationId, toStationId, tariffs, routeId, }: RoutePayload, signal?: GenericAbortSignal) => Promise<void>;\r\n    loading: boolean;\r\n};\r\nexport default useTimeTickets;\r\n"}}
